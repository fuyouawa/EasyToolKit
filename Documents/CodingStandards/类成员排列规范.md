# 类成员排列规范

## 普通类成员排列顺序

**排列顺序**（从上到下）：

1. 常量（`const`）
2. 静态只读字段（`static readonly`）
3. 静态字段（`static`）
4. 实例字段（`private`/`protected`）
5. 构造函数
6. 属性（`Properties`）
7. 方法（`Methods`）

**访问修饰符顺序**：`public` → `protected` → `private`

---

### 普通类示例

```csharp
public class Example
{
    // ====== 常量 ======
    public const int MaxCount = 100;
    private const string DefaultName = "Unknown";

    // ====== 静态只读字段 ======
    public static readonly Example Empty = new Example();
    private static readonly Random _rng = new Random();

    // ====== 静态字段 ======
    private static int s_globalCounter;

    // ====== 实例字段 ======
    private int _id;
    private string _name;

    // ====== 构造函数 ======
    public Example(int id, string name)
    {
        _id = id;
        _name = name;
    }

    // ====== 属性 ======
    public int Id => _id;

    public string Name
    {
        get => _name;
        set => _name = value ?? DefaultName;
    }

    // ====== 公共方法 ======
    public static Example CreateRandom()
    {
        return new Example(_rng.Next(MaxCount), "Random");
    }

    // ====== 私有方法 ======
    private void Reset()
    {
        _id = 0;
        _name = DefaultName;
    }
}
```

---

## Unity 类成员排列顺序

**Unity 特殊排列顺序**（从上到下）：

1. 常量 / 静态字段
2. 序列化字段（`[SerializeField]`）
3. 私有字段
4. 公共属性
5. Unity 生命周期方法（按调用顺序）
6. 公共方法
7. 私有方法
8. 协程

**序列化字段规范**：
- 序列化字段最好使用 `[SerializeField]` 加上 `private` 访问修饰符
- 如果需要外部访问，通过属性提供访问接口
- 属性可以包含验证逻辑，确保数据安全

### Unity 类示例

```csharp
using UnityEngine;

public class PlayerController : MonoBehaviour
{
    // ====== 常量 / 静态字段 ======
    private const float MaxHealth = 100f;
    private static readonly Vector3 DefaultSpawn = Vector3.zero;

    // ====== 序列化字段 ======
    [SerializeField] private float _moveSpeed = 5f;
    [SerializeField] private Rigidbody2D _rigidbody;
    [SerializeField] private float _maxHealth = 100f;

    // ====== 私有字段 ======
    private float _health;
    private Vector2 _input;

    // ====== 公共属性 ======
    public bool IsAlive => _health > 0;

    public float MoveSpeed
    {
        get => _moveSpeed;
        set => _moveSpeed = Mathf.Max(0, value);
    }

    public float MaxHealth => _maxHealth;

    public float Health
    {
        get => _health;
        private set => _health = Mathf.Clamp(value, 0, _maxHealth);
    }

    // ====== Unity 生命周期方法 ======
    private void Awake()
    {
        _health = MaxHealth;
    }

    private void OnEnable()
    {
        // 注册事件
    }

    private void Start()
    {
        Spawn(DefaultSpawn);
    }

    private void Update()
    {
        HandleInput();
    }

    private void FixedUpdate()
    {
        Move();
    }

    private void OnDisable()
    {
        // 取消注册事件
    }

    private void OnDestroy()
    {
        // 清理资源
    }

    // ====== 公共方法 ======
    public void TakeDamage(float amount)
    {
        _health = Mathf.Max(0, _health - amount);
    }

    // ====== 私有方法 ======
    private void HandleInput()
    {
        _input = new Vector2(Input.GetAxis("Horizontal"), Input.GetAxis("Vertical"));
    }

    private void Move()
    {
        _rigidbody.velocity = _input * _moveSpeed;
    }

    private void Spawn(Vector3 position)
    {
        transform.position = position;
    }

    // ====== 协程 ======
    private System.Collections.IEnumerator RespawnCoroutine()
    {
        yield return new WaitForSeconds(3f);
        Spawn(DefaultSpawn);
        _health = MaxHealth;
    }
}
```

---

## Unity 生命周期方法调用顺序

Unity 生命周期方法按以下顺序调用：

1. **Awake** - 脚本实例被加载时调用
2. **OnEnable** - 对象启用时调用
3. **Start** - 第一帧更新前调用
4. **FixedUpdate** - 固定时间间隔调用（物理计算）
5. **Update** - 每帧调用一次
6. **LateUpdate** - Update 后调用
7. **OnDisable** - 对象禁用时调用
8. **OnDestroy** - 对象销毁时调用

---
