# å‘½åè§„èŒƒ

## ç›®å½•

- [å˜é‡å‘½åè§„èŒƒ](#å˜é‡å‘½åè§„èŒƒ)
  - [é€šç”¨æ³•åˆ™](#é€šç”¨æ³•åˆ™)
  - [æ™®é€šé›†åˆ](#æ™®é€šé›†åˆ)
  - [Dictionary](#dictionary)
  - [TaskCompletionSource](#taskcompletionsource)
  - [Event](#event)
  - [Delegate](#delegate)
  - [æ’åº/æ¯”è¾ƒå™¨](#æ’åºæ¯”è¾ƒå™¨)
- [å‡½æ•°å‘½åè§„èŒƒ](#å‡½æ•°å‘½åè§„èŒƒ)
  - [è·å–ç±»å‡½æ•°å‰ç¼€](#è·å–ç±»å‡½æ•°å‰ç¼€)
  - [è®¡ç®—ç±»å‡½æ•°å‰ç¼€](#è®¡ç®—ç±»å‡½æ•°å‰ç¼€)
  - [å‡½æ•°åç¼€](#å‡½æ•°åç¼€)
  - [é“¾å¼è°ƒç”¨](#é“¾å¼è°ƒç”¨)

---

## å˜é‡å‘½åè§„èŒƒ

### é€šç”¨æ³•åˆ™

é™¤äº†å¸¸ç”¨çš„é‚£äº›åè¯å…è®¸ç¼©å†™ï¼Œå…¶ä»–çš„éƒ½å°½é‡ä¸è¦ä½¿ç”¨ç¼©å†™ã€‚

> ğŸ’¡ **ç›¸å…³æ–‡æ¡£**ï¼šå…³äº `var` å…³é”®å­—çš„ä½¿ç”¨è§„èŒƒï¼Œè¯·å‚é˜… [ä»£ç é£æ ¼æŒ‡å—](./ä»£ç é£æ ¼æŒ‡å—.md)

---

### æ™®é€šé›†åˆ

**å†™æ³•**ï¼šä½¿ç”¨**å¤æ•°**å½¢å¼

**ç¤ºä¾‹**ï¼š

```csharp
List<Player> players;
Player[] onlinePlayers;
Dictionary<int, Enemy> enemies;
```

---

### Dictionary

**å†™æ³•**ï¼šä½¿ç”¨ **XxxByYyy**ï¼ˆ**ValueByKey**ï¼‰é£æ ¼

**è§„åˆ™**ï¼š
- `Xxx` ä½¿ç”¨å•æ•°ï¼Œé™¤éæ˜¯é›†åˆç±»å‹
- **è¯­ä¹‰**ï¼š`Xxx` æ˜¯æ ¹æ® `Yyy` å¾—åˆ°çš„

**ç¤ºä¾‹**ï¼š

```csharp
// å•ä¸ªå€¼
Dictionary<int, Player> playerById;
Dictionary<string, Item> itemByName;

// é›†åˆå€¼ï¼ˆXxx ç”¨å¤æ•°ï¼‰
Dictionary<string, AssetInfo[]> assetInfosByPackageName;
Dictionary<int, List<Quest>> questsByPlayerId;
```

---

### TaskCompletionSource

**å†™æ³•**ï¼š**åŠ¨ä½œè¯­ä¹‰** + **Tcs** åç¼€

**ç¤ºä¾‹**ï¼š

```csharp
TaskCompletionSource<int> clickCompletedTcs;
TaskCompletionSource<bool> loginTcs;
Dictionary<string, UniTaskCompletionSource<UnityEngine.Object>> assetLoadTcsByName;
```

---

### Event

**å†™æ³•**ï¼š`Xxxing` / `Xxxed`ï¼ˆä¸åŠ  `On` å‰ç¼€ï¼‰

**åŸºæœ¬åŸåˆ™**ï¼š

1. **äº‹ä»¶å**åº”è¯¥æè¿°"å‘ç”Ÿäº†ä»€ä¹ˆ"ï¼Œè€Œä¸æ˜¯"å»åšä»€ä¹ˆ"
   - âœ… `Closed`ã€`Clicked`ã€`Completed`
   - âŒ `Close`ã€`Click`ã€`Complete`

2. ä¸è¦ç»™äº‹ä»¶åŠ  `On` å‰ç¼€ï¼Œ`OnXxx` ä¸€èˆ¬ä¿ç•™ç»™è§¦å‘äº‹ä»¶çš„æ–¹æ³•

3. **æ—¶æ€åŒºåˆ†**ï¼š
   - `Xxxing` â†’ è¡¨ç¤º"æ­£åœ¨è¿›è¡Œï¼Œå¯ä»¥è¢«å–æ¶ˆæˆ–å¹²é¢„"
     - ä¾‹ï¼š`Closing`ã€`Loading`ã€`Connecting`
   - `Xxxed` â†’ è¡¨ç¤º"å·²ç»å®Œæˆï¼Œé€šçŸ¥å¤–éƒ¨ç»“æœ"
     - ä¾‹ï¼š`Closed`ã€`Loaded`ã€`Connected`

**ç¤ºä¾‹**ï¼š

```csharp
public class Window
{
    // äº‹ä»¶å®šä¹‰
    public event Action Closing;                    // çª—å£æ­£åœ¨å…³é—­
    public event Action Closed;                     // çª—å£å·²ç»å…³é—­
    public event Action<Exception> CloseFailed;     // çª—å£å…³é—­å¤±è´¥

    // è§¦å‘æ–¹æ³•ï¼ˆä½¿ç”¨ On å‰ç¼€ï¼‰
    protected virtual void OnClosing() => Closing?.Invoke();
    protected virtual void OnClosed() => Closed?.Invoke();
    protected virtual void OnCloseFailed(Exception ex) => CloseFailed?.Invoke(ex);
}
```

---

### Delegate

**å†™æ³•**ï¼šæ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œä½¿ç”¨ç›¸åº”çš„åç¼€å‘½å

**åŸºæœ¬åŸåˆ™**ï¼š

1. Delegate é€šå¸¸è¡¨ç¤ºä¸€ç±»æ–¹æ³•ç­¾åï¼Œåº”æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©é€‚å½“çš„åç¼€
2. Delegate åç§°åº”ä½“ç°**å®ƒè¦å¤„ç†çš„é€»è¾‘æˆ–åŠ¨ä½œ**ï¼Œé¿å…æ¨¡ç³Š
3. Delegate å‘½åä¸äº‹ä»¶ç›¸é…åˆæ—¶ï¼Œåº”ä¸äº‹ä»¶åçš„è¯­ä¹‰ä¿æŒä¸€è‡´
4. æ¯ä¸ªåœºæ™¯æœ‰ç‰¹å®šçš„åç¼€çº¦å®šï¼Œåº”æ ¹æ®å®é™…ç”¨é€”é€‰æ‹©æœ€åˆé€‚çš„åç¼€

#### XxxHandler åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"å¤„ç†æŸäº‹çš„æ–¹æ³•"ï¼Œä¸“é—¨ç”¨äºäº‹ä»¶æˆ–æ¶ˆæ¯å¤„ç†
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - äº‹ä»¶å›è°ƒã€æ¶ˆæ¯å¤„ç†ã€ç”¨æˆ·è¾“å…¥å“åº”
  - å¼‚æ­¥æ“ä½œå®Œæˆå›è°ƒã€çŠ¶æ€å˜æ›´é€šçŸ¥
  - ç³»ç»Ÿäº‹ä»¶ç›‘å¬ã€ä¸šåŠ¡é€»è¾‘è§¦å‘
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // çª—å£å…³é—­äº‹ä»¶å¤„ç†
  public delegate void WindowClosedHandler(Window window);
  public event WindowClosedHandler Closed;
  ```

#### XxxInvoker åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è°ƒç”¨é€»è¾‘çš„æ–¹æ³•"ï¼Œè´Ÿè´£æ‰§è¡Œæˆ–è°ƒåº¦ç‰¹å®šæ“ä½œ
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤æ‰§è¡Œ
  - è¿œç¨‹æ–¹æ³•è°ƒç”¨ã€å‡½æ•°è°ƒåº¦
  - å¼‚æ­¥ä»»åŠ¡è§¦å‘ã€å·¥ä½œé¡¹æ‰§è¡Œ
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // å‘½ä»¤æ‰§è¡Œå™¨
  public delegate void CommandInvoker(CommandContext context);
  public CommandInvoker ExecuteCommand;
  ```

#### XxxResolver åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è§£ææŸ¥æ‰¾çš„æ–¹æ³•"ï¼Œè´Ÿè´£è§£æã€æŸ¥æ‰¾æˆ–ç¡®å®šç‰¹å®šå€¼
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ä¾èµ–è§£æã€æœåŠ¡å®šä½
  - é…ç½®è§£æã€è·¯å¾„è§£æ
  - å†²çªè§£å†³ã€ç­–ç•¥é€‰æ‹©
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ä¾èµ–è§£æ
  public delegate object DependencyResolver(Type serviceType);
  public DependencyResolver ResolveService;
  ```

#### XxxFactory åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"åˆ›å»ºå®ä¾‹çš„æ–¹æ³•"ï¼Œè´Ÿè´£åˆ›å»ºç‰¹å®šç±»å‹çš„å¯¹è±¡å®ä¾‹
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å¯¹è±¡åˆ›å»ºã€å®ä¾‹åŒ–
  - å¤æ‚å¯¹è±¡æ„å»º
  - æ± åŒ–å¯¹è±¡è·å–
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // å¯¹è±¡å·¥å‚
  public delegate GameObject GameObjectFactory(Vector3 position);
  public GameObjectFactory CreateGameObject;
  ```

#### XxxGetter åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è·å–å€¼çš„æ–¹æ³•"ï¼Œä¸“é—¨ç”¨äºè·å–ç‰¹å®šå€¼æˆ–å±æ€§
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å±æ€§è®¿é—®ã€æ•°æ®æ£€ç´¢
  - è®¡ç®—å€¼è·å–ã€çŠ¶æ€æŸ¥è¯¢
  - é…ç½®è·å–ã€è®¾ç½®è¯»å–
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // å±æ€§è·å–
  public delegate string PropertyGetter(object target);
  public PropertyGetter GetPropertyValue;
  ```

#### XxxConverter åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"ç±»å‹è½¬æ¢çš„æ–¹æ³•"ï¼Œè´Ÿè´£åœ¨ä¸åŒç±»å‹æˆ–æ ¼å¼ä¹‹é—´è½¬æ¢
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ç±»å‹è½¬æ¢ã€æ•°æ®æ ¼å¼åŒ–
  - åºåˆ—åŒ–/ååºåˆ—åŒ–
  - ç¼–ç /è§£ç ã€å•ä½è½¬æ¢
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç±»å‹è½¬æ¢
  public delegate TOutput TypeConverter<TInput, TOutput>(TInput input);
  public TypeConverter<string, int> StringToIntConverter;
  ```

#### XxxPredicate åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"æ¡ä»¶åˆ¤æ–­çš„æ–¹æ³•"ï¼Œè¿”å› `bool` è¡¨ç¤ºæ˜¯å¦æ»¡è¶³æ¡ä»¶
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - æ¡ä»¶åˆ¤æ–­ã€è¿‡æ»¤ç­›é€‰
  - éªŒè¯æ£€æŸ¥ã€çº¦æŸè¯„ä¼°
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // æ¡ä»¶åˆ¤æ–­
  public delegate bool PlayerPredicate(Player player);
  public PlayerPredicate IsPlayerAlive;
  ```

#### XxxEvaluator åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è®¡ç®—è¯„ä¼°çš„æ–¹æ³•"ï¼Œè¿”å›è®¡ç®—ç»“æœæˆ–è¯„ä¼°å€¼
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - æ•°å€¼è®¡ç®—ã€è¯„åˆ†è¯„ä¼°
  - ä¼˜å…ˆçº§è®¡ç®—ã€æƒé‡è¯„ä¼°
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ä¼¤å®³è®¡ç®—
  public delegate int DamageEvaluator(Player attacker, Player target);
  public DamageEvaluator CalculateDamage;
  ```

---

### æ’åº/æ¯”è¾ƒå™¨

**åŸºæœ¬åŸåˆ™**ï¼š

1. **ä¸€æ¬¡æ€§ Lambda è¡¨è¾¾å¼**ï¼šä½¿ç”¨ **aã€b** ä½œä¸ºå‚æ•°å
   - é€‚ç”¨äºå†…è”çš„ã€ä¸€æ¬¡æ€§çš„æ’åºé€»è¾‘
   - ç®€æ´æ˜äº†ï¼Œç¬¦åˆ C# ç¤¾åŒºçº¦å®š

2. **å…¬å…±æ–¹æ³• / å·¥å…·ç±»**ï¼šä½¿ç”¨ **leftã€right** ä½œä¸ºå‚æ•°å
   - é€‚ç”¨äºå¯é‡ç”¨çš„æ¯”è¾ƒæ–¹æ³•
   - è¯­ä¹‰æ›´æ¸…æ™°ï¼Œä¾¿äºç†è§£

**ç¤ºä¾‹**ï¼š

```csharp
// âœ… ä¸€æ¬¡æ€§ Lambda è¡¨è¾¾å¼ - ä½¿ç”¨ aã€b
list.Sort((a, b) => a.Id.CompareTo(b.Id));
items.OrderBy((a, b) => a.Priority.CompareTo(b.Priority));

// âœ… å…¬å…±æ¯”è¾ƒæ–¹æ³• - ä½¿ç”¨ leftã€right
public int Compare(Item left, Item right)
{
    return left.Id.CompareTo(right.Id);
}
```

---

## å‡½æ•°å‘½åè§„èŒƒ

### è·å–ç±»å‡½æ•°å‰ç¼€

#### Get å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è·å–"ï¼Œé¢„æœŸä¸€å®šèƒ½æ‰¾åˆ°ç›®æ ‡ï¼Œæ‰¾ä¸åˆ°æ—¶æŠ›å‡ºå¼‚å¸¸
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - æ—¶é—´å¤æ‚åº¦é€šå¸¸ä¸º O(1)
  - é¢„æœŸç›®æ ‡ä¸€å®šå­˜åœ¨
  - æ‰¾ä¸åˆ°æˆ–å‡ºé”™æ—¶æŠ›å‡ºå¼‚å¸¸
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šä»å­—å…¸ä¸­è·å–ç©å®¶ï¼Œæ‰¾ä¸åˆ°æ—¶æŠ›å¼‚å¸¸
  public Player GetPlayer(int playerId)
  {
      if (!_players.TryGetValue(playerId, out var player))
          throw new PlayerNotFoundException(playerId);
      return player;
  }
  ```

#### Find å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"æŸ¥æ‰¾"ï¼Œå¯èƒ½éœ€è¦æœç´¢/éå†ï¼Œæ‰¾ä¸åˆ°æ—¶è¿”å› null
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é€šå¸¸éœ€è¦æœç´¢/éå†/åŒ¹é…æ¡ä»¶
  - æ—¶é—´å¤æ‚åº¦å¯èƒ½å¤§äº O(1)
  - æ‰¾ä¸åˆ°æ—¶è¿”å› null
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šæ ¹æ®åç§°æŸ¥æ‰¾ç©å®¶ï¼Œå¯èƒ½æ‰¾ä¸åˆ°
  public Player FindPlayerByName(string name)
  {
      return _players.Values.FirstOrDefault(p => p.Name == name);
  }
  ```

#### TryGet å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"å®‰å…¨è·å–"ï¼Œè¿”å› bool è¡¨ç¤ºæˆåŠŸ/å¤±è´¥ï¼Œé€šè¿‡ out å‚æ•°ä¼ å‡ºç»“æœ
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - Get çš„å¼‚å¸¸å®‰å…¨ç‰ˆæœ¬
  - è¿”å› bool è¡¨ç¤ºæˆåŠŸ/å¤±è´¥
  - ç»“æœé€šè¿‡ out å‚æ•°è¿”å›
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šå®‰å…¨è·å–ç©å®¶ï¼Œä¸æŠ›å¼‚å¸¸
  public bool TryGetPlayer(int playerId, out Player player)
  {
      return _players.TryGetValue(playerId, out player);
  }
  ```

---

### è®¡ç®—ç±»å‡½æ•°å‰ç¼€

#### Compute å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼šé€šè¿‡ç®—æ³•æˆ–é€»è¾‘è¿‡ç¨‹æ¨å¯¼ç»“æœ
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - æ›´æŠ½è±¡ã€æ›´æ™ºèƒ½ã€å¯åŒ…å«å¤šæ­¥éª¤æ¨ç†
  - å¤æ‚é€»è¾‘ã€é…ç½®æ¨å¯¼ã€è·¯å¾„è§„åˆ’ã€çŠ¶æ€è¯„ä¼°
  - æ€§èƒ½æ•æ„Ÿçš„è®¡ç®—æ“ä½œ
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šéœ€è¦è¯»å–é…ç½®ã€ç­›é€‰ã€æ¨å¯¼ï¼Œéå•çº¯ç®—å¼
  public float ComputeLearnableSkills(Player target);
  ```

#### Calculate å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼šé€šè¿‡æ•°å­¦å…¬å¼æˆ–æ˜ç¡®ç®—å¼å¾—å‡ºç»“æœ
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - æ›´ç²¾ç¡®ã€æ›´æ•°å­¦åŒ–ã€ä¸€æ­¥åˆ°ä½çš„æ•°å€¼è®¡ç®—
  - æ•°å€¼ã€æ¯”ä¾‹ã€ä¼¤å®³ã€æ•°å€¼æˆé•¿
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šè®¡ç®—ç»éªŒå€¼éœ€æ±‚ï¼Œæœ‰å›ºå®šæ•°å­¦å…¬å¼æˆ–æ¯”ä¾‹
  public int CalculateExpRequired(int currentLevel);
  ```

#### Can å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"èƒ½å¦"ï¼Œç”¨äºåˆ¤æ–­æŸä¸ªæ“ä½œæ˜¯å¦å¯è¡Œ
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å…·å¤‡æ‰§è¡ŒæŸè¡Œä¸ºçš„æ¡ä»¶
  - åˆ¤æ–­èƒ½åšä¸åš
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šåˆ¤æ–­ç©å®¶èƒ½å¦ä½¿ç”¨æŠ€èƒ½
  public bool CanUseSkill(Player player, Skill skill);
  ```

#### Is å‰ç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"æ˜¯å¦"ï¼Œç”¨äºåˆ¤æ–­çŠ¶æ€æˆ–å±æ€§
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - "å½“å‰å…·å¤‡æŸç§çŠ¶æ€"
  - åˆ¤æ–­æ˜¯ä¸å¦
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // ç¤ºä¾‹ï¼šåˆ¤æ–­ç©å®¶æ˜¯å¦åœ¨çº¿
  public bool IsPlayerOnline(int playerId);
  ```

---

### å‡½æ•°åç¼€

#### ByXxx åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"æ ¹æ®Xxxæ¥..."
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é€šè¿‡å”¯ä¸€æ ‡è¯†ç¬¦æŸ¥æ‰¾ï¼š`ById`, `ByName`, `ByKey`
  - é€šè¿‡æ¡ä»¶ç­›é€‰ï¼š`ByLevel`, `ByStatus`, `ByType`
  - é€šè¿‡å‚æ•°åŒ¹é…ï¼š`ByAccount`, `ByEmail`, `ByPhone`
- **ç¤ºä¾‹**ï¼š
  ```csharp
  public Player GetPlayerById(int id);
  public Item FindItemByName(string name);
  public bool TryGetConfigByKey(string key, out Config config);
  ```

#### AtXxx åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"åœ¨Xxxä½ç½®/æ—¶é—´..."
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ç©ºé—´ä½ç½®ï¼š`AtPosition`, `AtCoordinate`, `AtLocation`
  - æ•°ç»„ç´¢å¼•ï¼š`AtIndex`, `AtSlot`, `AtPosition`
  - æ—¶é—´ç‚¹ï¼š`AtTime`, `AtDate`, `AtTimestamp`
- **ç¤ºä¾‹**ï¼š
  ```csharp
  public Item GetItemAt(Vector3 position);
  public Enemy FindEnemyAt(Vector2 coord);
  public bool TryGetTileAt(int x, int y, out Tile tile);
  ```

#### OfXxx åç¼€
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"å±äºXxxçš„..." æˆ– "å…·æœ‰Xxxå±æ€§çš„..."
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å½’å±å…³ç³»ï¼š`OfPlayer`, `OfTeam`, `OfGuild`
  - å±æ€§å…³ç³»ï¼š`OfType`, `OfCategory`, `OfRarity`
  - ç»„æˆéƒ¨åˆ†ï¼š`OfSystem`, `OfModule`, `OfComponent`
- **ç¤ºä¾‹**ï¼š
  ```csharp
  public Skill GetSkillOfPlayer(int playerId);
  public List<Item> FindItemsOfType(ItemType type);
  public bool TryGetConfigOfModule(string module, out Config config);
  ```

#### åç¼€ä½¿ç”¨åŸåˆ™

**å¿…é¡»ä½¿ç”¨åç¼€çš„æƒ…å†µ**ï¼š

1. åŒä¸€ä¸ªå®ä½“æ”¯æŒå¤šç§ key æŸ¥æ‰¾æ—¶ï¼Œå¿…é¡»æ˜¾å¼åŒºåˆ†
   ```csharp
   // âœ… æ­£ç¡®ï¼šæ˜ç¡®åŒºåˆ†ä¸åŒçš„æŸ¥æ‰¾æ–¹å¼
   public Player GetPlayerById(int id);
   public Player GetPlayerByName(string name);
   public Player GetPlayerByAccount(string account);
   ```

2. å‚æ•°ç±»å‹ç›¸åŒï¼Œä½†è¯­ä¹‰ä¸åŒï¼Œéœ€è¦å†™æ¸…æ¥š
   ```csharp
   // âœ… æ­£ç¡®ï¼šè™½ç„¶éƒ½æ˜¯intå‚æ•°ï¼Œä½†è¯­ä¹‰ä¸åŒ
   public Item GetItemById(int id);        // æ ¹æ®ç‰©å“IDè·å–
   public Item GetItemByIndex(int index);  // æ ¹æ®ç´¢å¼•ä½ç½®è·å–
   ```

**å¯ä»¥ä¸åŠ åç¼€çš„æƒ…å†µ**ï¼š

- ä¸Šä¸‹æ–‡å·²æ˜ç¡®è¯­å¢ƒï¼Œç±»å/å‘½åç©ºé—´å·²ç»è¯´æ˜äº†"æŸ¥æ‰¾åŸºå‡†"
  ```csharp
  // âœ… æ­£ç¡®ï¼šåœ¨PlayerManagerç±»ä¸­ï¼ŒGetPlayeré»˜è®¤æŒ‰IDæŸ¥æ‰¾
  public class PlayerManager
  {
      public Player GetPlayer(int playerId);  // ä¸éœ€è¦GetPlayerById
  }
  ```

- æ˜ç¡®åªæœ‰ä¸€ç§æŸ¥æ‰¾æ–¹å¼ï¼Œè¯­ä¹‰å”¯ä¸€
  ```csharp
  // âœ… æ­£ç¡®ï¼šåœ°å›¾ç±»ä¸­åªæœ‰æŒ‰åæ ‡æŸ¥æ‰¾ä¸€ç§æ–¹å¼
  public class Map
  {
      public Tile GetTile(Vector3 position);  // ä¸éœ€è¦GetTileAt
  }
  ```

**ä¸ç¡®å®šåŸåˆ™**ï¼šå¦‚æœä¸ç¡®å®šåç»­æ˜¯å¦ä¼šç”±äºAPIå¢åŠ å¯¼è‡´ä¸æ»¡è¶³ä¸åŠ åç¼€çš„æƒ…å†µï¼Œé‚£ä¹ˆä½¿ç”¨åŠ åç¼€çš„åŸåˆ™

---

### é“¾å¼è°ƒç”¨

é“¾å¼è°ƒç”¨æ–¹æ³•ç”¨äºé…ç½®å¯¹è±¡å±æ€§å¹¶è¿”å›è‡ªèº«ä»¥æ”¯æŒè¿ç»­æ“ä½œã€‚æ ¹æ®æ“ä½œç±»å‹åˆ†ä¸ºç›´æ¥èµ‹å€¼ã€é™åˆ¶æ“ä½œå’Œå¢é‡æ“ä½œã€‚

#### WithXxx å‰ç¼€ï¼ˆç›´æ¥èµ‹å€¼ï¼‰
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"ç›´æ¥è®¾ç½®å±æ€§å€¼ä¸ºæŒ‡å®šå€¼"
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ç›´æ¥èµ‹å€¼æ“ä½œï¼Œç”¨æ–°å€¼æ›¿æ¢å½“å‰å€¼
  - Builder æ¨¡å¼çš„é…ç½®æ–¹æ³•
  - æ‰©å±•æ–¹æ³•æä¾›é“¾å¼é…ç½®èƒ½åŠ›
- **ç¤ºä¾‹**ï¼š
  ```csharp
  // Builder æ¨¡å¼ç¤ºä¾‹
  public class PlayerBuilder
  {
      private string _name;
      private int _level;

      public PlayerBuilder WithName(string name)
      {
          _name = name;
          return this;
      }

      public PlayerBuilder WithLevel(int level)
      {
          _level = level;
          return this;
      }

      public Player Build() => new Player(_name, _level);
  }

  // ä½¿ç”¨
  var player = new PlayerBuilder()
      .WithName("Hero")
      .WithLevel(1)
      .Build();
  ```

  ```csharp
  // Rect æ‰©å±•æ–¹æ³•ç¤ºä¾‹
  public static class RectExtensions
  {
      public static Rect WithX(this Rect rect, float x)
      {
          rect.x = x;
          return rect;
      }

      public static Rect WithY(this Rect rect, float y)
      {
          rect.y = y;
          return rect;
      }

      public static Rect WithWidth(this Rect rect, float width)
      {
          rect.width = width;
          return rect;
      }

      public static Rect WithHeight(this Rect rect, float height)
      {
          rect.height = height;
          return rect;
      }
  }

  // ä½¿ç”¨
  var rect = new Rect(0, 0, 100, 100)
      .WithX(50)
      .WithY(30)
      .WithWidth(200);
  ```

#### WithXxxXxx å‰ç¼€ï¼ˆé™åˆ¶æ“ä½œï¼‰
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"è®¾ç½®å±æ€§å€¼å¹¶è¿›è¡Œé™åˆ¶/çº¦æŸ"
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å¸¦èŒƒå›´çš„èµ‹å€¼æ“ä½œ
  - å¸¦éªŒè¯çš„èµ‹å€¼æ“ä½œ
  - éœ€è¦ç‰¹æ®Šå¤„ç†çš„èµ‹å€¼æ“ä½œ
- **ç¤ºä¾‹**ï¼š
  ```csharp
  public static class RectExtensions
  {
      public static Rect WithXClamped(this Rect rect, float x, float min, float max)
      {
          rect.x = Mathf.Clamp(x, min, max);
          return rect;
      }

      public static Rect WithHeightClamped(this Rect rect, float height, float min, float max)
      {
          rect.height = Mathf.Clamp(height, min, max);
          return rect;
      }

      public static Rect WithWidthNormalized(this Rect rect, float width)
      {
          rect.width = Mathf.Clamp01(width);
          return rect;
      }

      public static Rect WithPositionRounded(this Rect rect, Vector2 position)
      {
          rect.position = new Vector2(Mathf.Round(position.x), Mathf.Round(position.y));
          return rect;
      }
  }

  // ä½¿ç”¨ç¤ºä¾‹
  var rect = new Rect(0, 0, 100, 100)
      .WithXClamped(150, 0, 100)      // xä¼šè¢«é™åˆ¶åœ¨0-100èŒƒå›´å†…
      .WithHeightClamped(80, 10, 50); // heightä¼šè¢«é™åˆ¶åœ¨10-50èŒƒå›´å†…
  ```

#### WithXxxBy å‰ç¼€ï¼ˆå¢é‡æ“ä½œï¼‰
- **æ ¸å¿ƒè¯­ä¹‰**ï¼š"åœ¨å½“å‰å€¼åŸºç¡€ä¸Šè¿›è¡Œå¢é‡ä¿®æ”¹"
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - ç›¸å¯¹ä½ç§»/åç§»æ“ä½œ
  - å¢é‡ä¿®æ”¹å°ºå¯¸
  - åŸºäºå½“å‰å€¼çš„è°ƒæ•´æ“ä½œ
- **ç¤ºä¾‹**ï¼š
  ```csharp
  public static class RectExtensions
  {
      public static Rect WithXOffsetBy(this Rect rect, float x)
      {
          rect.x += x;
          return rect;
      }

      public static Rect WithScaleBy(this Rect rect, float scaleFactor)
      {
          rect.width *= scaleFactor;
          rect.height *= scaleFactor;
          return rect;
      }
  }

  // ä½¿ç”¨ç¤ºä¾‹
  var rect = new Rect(100, 100, 50, 60)
      .WithXOffsetBy(10)
      .WithScaleBy(1.5f);
  ```

#### å‘½åå¯¹æ¯”æ€»ç»“

| æ“ä½œç±»å‹ | å‘½åæ ¼å¼ | ç¤ºä¾‹ | è¯­ä¹‰ |
|---------|---------|------|------|
| ç›´æ¥èµ‹å€¼ | `WithXxx(value)` | `WithX(100)` / `WithWidth(50)` | è®¾ç½®ä¸ºæŒ‡å®šå€¼ |
| é™åˆ¶æ“ä½œ | `WithXxxXxx(value, ...)` | `WithXClamped(x, min, max)` | è®¾ç½®å€¼å¹¶è¿›è¡Œé™åˆ¶ |
| å¢é‡æ“ä½œ | `WithXxxBy(delta)` | `WithXOffsetBy(10)` / `WithScaleBy(20)` | åœ¨å½“å‰å€¼åŸºç¡€ä¸Šå¢åŠ  |

#### è®¾è®¡åŸåˆ™

1. **WithXxx** - ç”¨äºç›´æ¥èµ‹å€¼ï¼Œå‚æ•°æ˜¯ç›®æ ‡å€¼
2. **WithXxxBy** - ç”¨äºå¢é‡æ“ä½œï¼Œå‚æ•°æ˜¯å˜åŒ–é‡ï¼ˆdeltaï¼‰
3. **WithXxxXxx** - ç”¨äºç‰¹æ®Šå¤„ç†ï¼Œå¦‚ Clampedã€Normalizedã€Rounded ç­‰
4. æ‰€æœ‰é“¾å¼æ–¹æ³•éƒ½åº”è¿”å› `this` ä»¥æ”¯æŒè¿ç»­è°ƒç”¨
5. æ–¹æ³•ååº”æ¸…æ™°è¡¨è¾¾æ“ä½œç±»å‹ï¼Œé¿å…æ­§ä¹‰

---
